apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Base 참조
resources:
  - ../../base
  - namespace.yaml
  - secrets.yaml

# 네임스페이스 설정
namespace: payment-dev

# 이미지 태그를 개발 환경용으로 변경
images:
  - name: api-gateway
    newName: your-registry/api-gateway
    newTag: dev-latest
  - name: user-service
    newName: your-registry/user-service
    newTag: dev-latest
  - name: payment-service
    newName: your-registry/payment-service
    newTag: dev-latest
  - name: settlement-service
    newName: your-registry/settlement-service
    newTag: dev-latest
  - name: partner-service
    newName: your-registry/partner-service
    newTag: dev-latest
  - name: accounting-service
    newName: your-registry/accounting-service
    newTag: dev-latest

# 환경별 패치 적용
patchesStrategicMerge:
  - replica-patch.yaml
  - redis-patch.yaml
  - kafka-patch.yaml

# ConfigMap 생성기 (환경 변수 오버라이드)
configMapGenerator:
  - name: global-config
    literals:
      - ENVIRONMENT=development
      - LOG_LEVEL=DEBUG
      - SPRING_PROFILES_ACTIVE=dev

# 공통 레이블에 환경 추가
commonLabels:
  environment: development

# 공통 어노테이션
commonAnnotations:
  environment: "development"
  managed-by: "kustomize"
